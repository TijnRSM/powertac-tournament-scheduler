<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:t="http://myfaces.apache.org/tomahawk">

<h:body>
	<ui:composition template="template.xhtml">
		<ui:define name="content">
      <link rel="stylesheet" type="text/css" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.8.2/css/jquery.dataTables.css"/>
      <script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.1.min.js"></script>
      <script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.8.2/jquery.dataTables.min.js"></script>
      <script type="text/javascript" src="datatable.sort.js"></script>

      <script type="text/javascript" charset="utf8" >
        $(document).ready(function() {
          $("[id$=runnning_games]").dataTable({
            "bFilter": false,
            "bInfo": false,
            "sScrollY": Math.min(400, $("[id$=runnning_games]").height()) + "px",
            "bPaginate": false,
            "aoColumnDefs": [
              { 'bSortable': false, 'aTargets': [2, 5] },
              { "sType": "natural", "aTargets": [0, 1] }
            ]
          });
          $("[id$=completed_games]").dataTable({
            "bFilter": false,
            "bInfo": false,
            "sScrollY": Math.min(400, $("[id$=completed_games]").height()) + "px",
            "bPaginate": false,
            "aoColumnDefs": [
              { 'bSortable': false, 'aTargets': [2, 4] },
              { "sType": "natural", "aTargets": [0, 1] }
            ]
          });
        });
      </script>

      <style type="text/css">
        table.dataTable tr.odd {
          background-color: #FFFFFF;
        }
        table.dataTable tr.odd td.sorting_1 {
          background-color: #FFFFFF;
        }
        table.dataTable tr.even td.sorting_1 {
          background-color: #FFFFFF;
        }
      </style>

      <h2>Welcome to the PowerTac 2012 Tournament Scheduler</h2>

      <p>More information on PowerTac, including the latest specification, can be found on the <a href="http://powertac.org">website</a>.</p>

      <p>If you have not already done so, create an account on the
        <a href="register.xhtml">registration page</a>.
      On the <a href="account.xhtml">account page</a> you can add/edit your broker(s).<br/>
      There you can also register your broker(s) to tournaments.<br/>
      Please register your broker to 'finals_2012_09' if you wish to participate in the 2012 PowerTAC competition.</p>

      <p>More information on the Broker login procedure found on the <a href="https://github.com/powertac/powertac-server/wiki/Broker-Tournament-Login">
			Github wiki instruction page</a>.</p>

			<h:form rendered="#{actionIndex.notCompleteGamesList.size() != 0}">
        <h3>Running Games and their Visualizers</h3>
				<t:dataTable id="runnning_games" border="1"
					style="border:1px solid black;border-collapse:collapse;text-align:center;"
					value="#{actionIndex.notCompleteGamesList}" var="g"
          styleClass="display dataTable" >
					<t:column>
						<f:facet name="header">
							<h:outputText value="ID" />
						</f:facet>
            <h:outputText value="#{g.gameId}" />
    			</t:column>
    				
          <t:column>
						<f:facet name="header">
							<h:outputText value="Tournament" />
						</f:facet>
            <h:outputText value="#{g.tournament.tournamentName}" />
          </t:column>
    				
          <t:column>
						<f:facet name="header">
							<h:outputText value="Brokers" />
						</f:facet>
            <h:outputText value="#{g.getBrokersInGameString()}" />
          </t:column>

					<t:column>
						<f:facet name="header">
							<h:outputText value="Status" />
						</f:facet>
            <h:outputText value="#{g.status}" />
    				</t:column>

					<t:column>
						<f:facet name="header">
							<h:outputText value="Start Time" />
						</f:facet>
            <h:outputText value="#{g.startTimeUTC()}" />
          </t:column>

					<t:column>
						<f:facet name="header">
							<h:outputText value="Viz&lt;br/&gt;Link" escape="false"/>
						</f:facet>
            <h:outputText value="Not avail." rendered="#{!g.isRunning()}"/>
            <h:panelGroup rendered="#{g.isRunning()}" >
              <a href="http://#{g.machine.vizUrl}" target="_blank">Visualizer</a>
            </h:panelGroup>
					</t:column>
				</t:dataTable>
			</h:form>

			<h:form rendered="#{actionIndex.completeGamesList.size() != 0}" >
        <h3>Complete Games and Logs</h3>
				<t:dataTable id="completed_games" border="1"
					style="border:1px solid black;border-collapse:collapse;text-align:center"
					value="#{actionIndex.completeGamesList}" var="g"
          styleClass="display dataTable" >
					<t:column>
						<f:facet name="header">
							<h:outputText value="ID" />
						</f:facet>
              <h:link value="#{g.gameId}" outcome="Game">
                <f:param name="gameId" value="#{g.gameId}" />
              </h:link>
    				</t:column>
    				
    				<t:column>
              <f:facet name="header">
                <h:outputText value="Tournament" />
              </f:facet>
              <h:link value="#{g.tournament.tournamentName}" outcome="Tournament">
                <f:param name="tournamentId" value="#{g.tournament.tournamentId}" />
              </h:link>
    				</t:column>

            <t:column>
              <f:facet name="header">
                <h:outputText value="Brokers" />
              </f:facet>
              <h:outputText value="#{g.getBrokersInGameString()}" />
            </t:column>

            <t:column>
              <f:facet name="header">
                <h:outputText value="Start Time" />
              </f:facet>
              <h:outputText value="#{g.readyTimeUTC()}" />
            </t:column>

    				<t:column>
						<f:facet name="header">
							<h:outputText value="Logs" />
						</f:facet>
              <a href="#{actionIndex.getLogUrl(g)}">Logs</a>
    				</t:column>
				</t:dataTable>
			</h:form>

      <br/><br/>
		</ui:define>
	</ui:composition>
</h:body>
</html>
